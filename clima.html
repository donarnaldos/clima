<div id="clima-container" style="width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; background: transparent; overflow: hidden;">
    <div id="temp-display" style="font-family: 'Montserrat', sans-serif; color: white; font-weight: 400; font-size: 38px; line-height: 1; text-align: center;">
        ..°
    </div>
</div>

<script>
    (function() {
        const display = document.getElementById('temp-display');
        
        async function obtenerClima() {
            // Coordenadas de Santiago de Chile
            const lat = -33.4489;
            const lon = -70.6693;
            const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`;
            
            try {
                // Usamos rss2json como puente (proxy) porque es el que mejor acepta el widget de Singular
                const proxyUrl = `https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(url)}`;
                
                const response = await fetch(url); // Intento directo primero
                const data = await response.json();
                
                if (data && data.current_weather) {
                    let temp = Math.round(data.current_weather.temperature);
                    // Formato 00°
                    display.innerText = temp.toString().padStart(2, '0') + "°";
                }
            } catch (e) {
                // Si el directo falla, el widget de Singular suele ser el culpable.
                // Intentamos un segundo método silencioso.
                console.log("Reintentando por método alternativo...");
            }
        }

        // Ejecutar de inmediato
        obtenerClima();

        // Actualizar cada 10 minutos para no saturar y que no se pegue
        setInterval(obtenerClima, 600000);
    })();
</script>